# Trigger

In SQL, a TRIGGER is a database object that automatically executes (or “fires”) a predefined block of SQL code in response to a specific event on a table or view.

Triggers are commonly used to enforce business rules, maintain audit logs, and ensure data integrity without relying on application-level logic.


## What is a Trigger?

A trigger:

Is associated with a table or view

Executes automatically

Fires on INSERT, UPDATE, or DELETE

Can run before or after the event

Is stored inside the database


## Basic Trigger Syntax

<p align="center">
  <img width="400" height="217" alt="image" src="https://github.com/user-attachments/assets/dbad63f7-6b47-4fe1-b80a-003bddcd92bd" />

</p>

### Create Table Products
```
CREATE TABLE products (
    product_id INT PRIMARY KEY,
    product_name VARCHAR(50),
    stock INT,
    price INT
);

```

### Insert Data in Products Table
```
INSERT INTO products (product_id, product_name, stock, price) VALUES
(1, 'Mobile', 10, 15000),
(2, 'Headphones', 20, 2000),
(3, 'Laptop', 5, 55000),
(4, 'Smart Watch', 15, 3000),
(5, 'Bluetooth Speaker', 12, 2500),
(6, 'Power Bank', 25, 1200),
(7, 'USB Cable', 50, 300);
```

### Create Table Orders

```
CREATE TABLE orders (
    order_id INT PRIMARY KEY,
    product_id INT,
    quantity INT,
    order_date DATE
);
```

## Create a Before Trigger

```
DELIMITER $$

CREATE TRIGGER before_order_insert
BEFORE INSERT ON orders2
FOR EACH ROW
BEGIN
    DECLARE available_stock INT;

    -- Get current stock of the ordered product
    SELECT stock
    INTO available_stock
    FROM products
    WHERE product_id = NEW.product_id;

    -- If stock is not enough, stop the order
    IF available_stock < NEW.quantity THEN
        SIGNAL SQLSTATE '45000'
        SET MESSAGE_TEXT = 'Insufficient stock for this product';
    END IF;
END$$

DELIMITER ;
```

## create a After Trigger

```
DELIMITER $$

CREATE TRIGGER after_order_insert
AFTER INSERT ON orders2
FOR EACH ROW
BEGIN
    UPDATE products
    SET stock = stock - NEW.quantity
    WHERE product_id = NEW.product_id;
END$$

DELIMITER ;
```

## Place the Order

```
INSERT INTO orders2 (order_id, product_id, quantity, order_date)
VALUES (101, 1, 2, '2026-01-01');
```











